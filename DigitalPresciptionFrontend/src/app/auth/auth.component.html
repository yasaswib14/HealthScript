<!-- ðŸ‘‡ Show Login/Register only when not in /dashboard -->
<ng-container *ngIf="!router.url.includes('/dashboard')">

  <!-- wrap main auth content so we can blur it -->
  <div class="auth-root" [class.blurred]="isRedirecting">
    <div class="split-card">
      <!-- Left Section -->
      <div class="left-section">
        <img src="assets/Logo.png" alt="Medical Logo" class="medical-logo" />
        <div class="welcome-title">Welcome To<br>HealthScript</div>
        <div class="welcome-subtitle">
          <br>{{ showRegister ? 'Creating your account...' : 'Login for free and manage your prescriptions.' }}
        </div>
        <button class="signup-btn" (click)="showRegister = true">
          {{ showRegister ? 'Fast. Safe. Digital.' : 'Sign Up' }}
        </button>
      </div>

      <!-- Right Section -->
      <div class="right-section">
        <div class="form-title">{{ showRegister ? 'Register' : 'Login' }}</div>

        <!-- Login Form -->
        <form *ngIf="!showRegister" #loginForm="ngForm" (ngSubmit)="onLogin(loginForm)">
          <div class="input-group">
            <label for="login-username">Username</label>
            <div class="input-wrapper">
              <input id="login-username" name="username" type="text" ngModel required autocomplete="username"
                placeholder="Your Username" />
            </div>
          </div>

          <div class="input-group">
            <label for="login-password">Password</label>
            <div class="input-wrapper">
              <input id="login-password" name="password" type="password" ngModel required minlength="6"
                autocomplete="current-password" placeholder="Your Password" />
            </div>
          </div>

          <button type="submit" class="login-btn">Sign In</button>
        </form>
        <!-- ðŸ”¥ Login form properly closed above -->

        <!-- Register Form -->
        <form *ngIf="showRegister" #registerForm="ngForm" (ngSubmit)="onRegister(registerForm)">
          <div class="input-group">
            <label for="register-username">Username</label>
            <div class="input-wrapper">
              <input id="register-username" name="username" type="text" ngModel required placeholder="Your Username" />
              <svg class="input-icon" viewBox="0 0 24 24">
                <circle cx="12" cy="8" r="4" />
                <path d="M4 20v-2a6 6 0 0 1 12 0v2" />
              </svg>
            </div>
          </div>

          <div class="input-group">
            <label for="register-email">Email</label>
            <div class="input-wrapper">
              <input id="register-email" name="email" type="email" ngModel required placeholder="Your Email" />
              <svg class="input-icon" viewBox="0 0 24 24">
                <rect x="2" y="7" width="20" height="10" rx="2" />
                <polyline points="2,7 12,13 22,7" />
              </svg>
            </div>
          </div>

          <div class="input-group">
            <label for="register-role">Role</label>
            <div class="input-wrapper">
              <select id="register-role" name="role" ngModel required
                (change)="selectedRole = registerForm.form.controls['role']?.value">
                <option value="" disabled selected>Select role</option>
                <option value="ROLE_DOCTOR">Doctor</option>
                <option value="ROLE_PATIENT">Patient</option>
              </select>
              <svg class="input-icon" viewBox="0 0 24 24">
                <rect x="3" y="11" width="18" height="7" rx="2" />
                <circle cx="12" cy="7" r="4" />
              </svg>
            </div>
          </div>

          <!-- ðŸ‘‡ Show Specialization if Doctor is selected -->
          <div class="input-group" *ngIf="registerForm.form.controls['role']?.value === 'ROLE_DOCTOR'">
            <label for="register-specialization">Specialization</label>
            <div class="input-wrapper">
              <select id="register-specialization" name="specialization" ngModel required>
                <option value="" disabled selected>Select specialization</option>
                <option value="Cardiologist">Cardiologist</option>
                <option value="Dermatologist">Dermatologist</option>
                <option value="Gastroenterologist">Gastroenterologist</option>
                <option value="Neurology">Neurology</option>
                <option value="Pediatrician">Pediatrician</option>
              </select>
              <svg class="input-icon" viewBox="0 0 24 24">
                <rect x="3" y="11" width="18" height="7" rx="2" />
                <circle cx="12" cy="7" r="4" />
              </svg>
            </div>
          </div>

          <div class="input-group">
            <label for="register-password">Password</label>
            <div class="input-wrapper">
              <input id="register-password" name="password" type="password" ngModel required minlength="6"
                placeholder="Your Password" />
              <svg class="input-icon" viewBox="0 0 24 24">
                <rect x="6" y="10" width="12" height="8" rx="2" />
                <path d="M9 10V7a3 3 0 0 1 6 0v3" />
              </svg>
            </div>
          </div>

          <button type="submit" class="register-btn">Sign Up</button>

          <div class="form-links" style="justify-content: flex-end;">
            <a href="#" class="register-link" (click)="showRegister = false">
              Already have an account? Login
            </a>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Redirect overlay shown when isRedirecting = true -->
  <div *ngIf="isRedirecting" class="redirect-overlay" aria-live="polite" role="status">
    <div class="overlay-content">
      <div class="spinner" aria-hidden="true"></div>
      <div class="redirect-text">Redirecting to login...</div>
    </div>
  </div>
</ng-container>

<!-- ðŸ‘‡ VERY IMPORTANT: This is where Angular will load the dashboard -->