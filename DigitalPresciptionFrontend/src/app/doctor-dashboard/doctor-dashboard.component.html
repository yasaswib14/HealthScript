<div class="doctor-dashboard">
            <!-- Custom Notification/Toast -->
            <div *ngIf="messageText" class="notification" [ngClass]="{'success-toast': showSuccess, 'error-toast': showError}">
                {{ messageText }}
            </div>

            <h1 class="header">üë®‚Äç‚öïÔ∏è Doctor Dashboard</h1>
<!-- <p class="subtext">Welcome, Doctor</p> -->

<div class="status-box">
    <strong>Status:</strong> {{ apiMessage }}
</div>

<hr>

<h2>üì© Patient Messages</h2>

<!-- ‚úÖ Show loader while fetching -->
<div *ngIf="isLoading">
    <p class="loader-text">Loading patient messages...</p>
    <div class="loader"></div>
</div>

    <!-- ‚úÖ Messages -->
    <div *ngIf="!isLoading && messages && messages.length > 0">
        <div *ngFor="let msg of messages" class="message-card" [ngClass]="{ 'severity-high': msg.severity === 'HIGH' }">
            <div class="message-header">
                <strong>From:</strong> {{ msg.sender?.username }}
                <span class="severity-tag" [ngClass]="{
            high: msg.severity === 'HIGH',
            medium: msg.severity === 'MEDIUM',
            low: msg.severity === 'LOW'
          }">
                    {{ msg.severity || 'LOW' }}
                </span>
            </div>

        <div class="message-body">
            <p><strong>Message:</strong> {{ msg.content }}</p>
            <p><strong>Time:</strong> {{ msg.timestamp | date:'medium' }}</p>
        </div>

        <!-- Respond form with multiple medications -->
        <form #prescriptionForm="ngForm" (ngSubmit)="respondToPatient(msg.id, prescriptionForm)"
            class="prescription-form">
            <input type="text" name="diagnosis" [(ngModel)]="diagnosis" required placeholder="Enter diagnosis"
                class="input-field" />

            <!-- Medications List -->
            <div class="medications-list">
                <div *ngFor="let med of medications; let i = index" class="medication-card">
                    <div class="medication-header">
                        <h4>Medication {{i + 1}}</h4>
                        <button type="button" *ngIf="medications.length > 1" 
                            (click)="removeMedication(i)" class="remove-btn">
                            <i class="fas fa-trash-alt"></i>
                            Remove Medication
                        </button>
                    </div>

                    <div class="medication-grid">
                        <!-- Medication Name -->
                        <div class="form-group full-width">
                            <label [for]="'medicationName-' + i">Medication Name</label>
                            <input type="text" [id]="'medicationName-' + i" 
                                [(ngModel)]="med.medicationName" 
                                [name]="'medicationName' + i" 
                                required 
                                placeholder="Enter medication name" 
                                class="input-field" />
                        </div>

                        <!-- Dosage Timing -->
                        <div class="form-group">
                            <label [for]="'dosageTiming-' + i">Dosage Timing</label>
                            <select [id]="'dosageTiming-' + i" 
                                [(ngModel)]="med.dosageTiming" 
                                [name]="'dosageTiming' + i" 
                                class="input-field" 
                                required>
                                <option value="">Select timing</option>
                                <option value="Morning">Morning</option>
                                <option value="Afternoon">Afternoon</option>
                                <option value="Evening">Evening</option>
                                <option value="Night">Night</option>
                                <option value="Morning, Night">Morning & Night</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>

                        <!-- Duration -->
                        <div class="form-group">
                            <label [for]="'durationDays-' + i">Duration</label>
                            <div class="input-group">
                                <input [id]="'durationDays-' + i" 
                                    [(ngModel)]="med.durationDays" 
                                    [name]="'durationDays' + i" 
                                    type="number" 
                                    min="1" 
                                    required
                                    placeholder="Number of days" 
                                    class="input-field" />
                                <span class="input-suffix">days</span>
                            </div>
                        </div>

                        <!-- Start Date -->
                        <div class="form-group">
                            <label [for]="'startDate-' + i">Start Date</label>
                            <input [id]="'startDate-' + i" 
                                [(ngModel)]="med.startDate" 
                                [name]="'startDate' + i" 
                                type="date" 
                                required
                                class="input-field" />
                        </div>
                    </div>
                </div>
            </div>

            <div class="prescription-buttons">
                <button type="button" (click)="addMedication()" class="btn-action btn-secondary">
                    <i class="fas fa-plus"></i> Add Medication
                </button>
                <button type="submit" [disabled]="isFormInvalid(prescriptionForm)" class="btn-action btn-primary">
                    <i class="fas fa-paper-plane"></i> Send Prescription
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Empty State -->
<div *ngIf="!isLoading && (!messages || messages.length === 0)" class="empty-state">
    <p>No messages assigned to you yet üïäÔ∏è</p>
</div>

<!-- Logout Button -->
<button class="logout-button" (click)="logout()">
    <i class="fas fa-sign-out-alt"></i> Logout
</button>


</div>